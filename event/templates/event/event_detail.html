{% extends "dashboard/dashNavFoot.html" %}
<title>{% block title %}Event Details{% endblock %}</title>

{% block dash %}
<div class="m-3">
  <div class="bg-gradient-to-r from-indigo-50 via-white to-indigo-50 min-h-screen flex items-center justify-center p-6">
    <div class="bg-white shadow-xl rounded-lg max-w-4xl w-full mx-auto p-10 md:p-14 lg:p-20">

      <!-- Messages -->
      {% if messages %}
        <div class="mb-4">
          {% for message in messages %}
            <div class="p-3 rounded-md text-white font-semibold
              {% if message.tags == 'success' %} bg-green-600
              {% elif message.tags == 'error' %} bg-red-600
              {% else %} bg-indigo-600
              {% endif %}">
              {{ message }}
            </div>
          {% endfor %}
        </div>
      {% endif %}

      <!-- Event Title -->
      <header class="mb-8">
        <h1 class="text-4xl font-extrabold text-gray-900 leading-tight">{{ event.name }}</h1>
        <p class="text-gray-600 mt-2">
          Category: <span class="font-semibold text-indigo-700">{{ event.category.name }}</span><br>
          <time datetime="{{ event.date|date:'c' }}" class="italic">
            {{ event.date|date:"F j, Y" }} at {{ event.time|time:"H:i A" }}
          </time>
        </p>
      </header>

      <!-- Event Image -->
      {% if event.image %}
      <section class="mb-8">
        <img src="{{ event.image.url }}" alt="Event Image"
             class="rounded-lg shadow-lg w-full max-h-[480px] object-cover mx-auto" />
      </section>
      {% endif %}

      <!-- Description -->
      <section class="mb-8">
        <h2 class="text-xl font-semibold text-gray-800 mb-4">Description</h2>
        <p class="text-gray-700 leading-relaxed text-lg">{{ event.description|default:"No description available." }}</p>
      </section>

      <!-- Location -->
      <section class="mb-8">
        <h2 class="text-xl font-semibold text-gray-800 mb-4">Location</h2>
        <p class="text-gray-700">{{ event.location }}</p>
      </section>

      <!-- Participants -->
      <section class="mb-8">
        <h2 class="text-xl font-semibold text-gray-800 mb-4">Participants</h2>
        <div class="flex flex-wrap gap-3">
          {% for participant in event.participants.all %}
            <span class="bg-indigo-100 text-indigo-800 text-sm font-medium rounded-full px-4 py-1 shadow-sm">
              {{ participant.get_full_name|default:participant.username }}
            </span>
          {% empty %}
            <span class="text-gray-500 italic">No participants yet.</span>
          {% endfor %}
        </div>
      </section>

      <!-- RSVP Form / Button -->
      {% if role == 'Participant' %}
        <div class="mt-6">
          {% if already_rsvped %}
            <button class="px-6 py-2 bg-green-500 text-white rounded-md shadow cursor-not-allowed" disabled>
              Already RSVPed
            </button>
          {% else %}
            <form method="post">
              {% csrf_token %}
              <div class="flex items-center gap-2 mb-2">
                {{ form.confirm }}
                <label for="{{ form.confirm.id_for_label }}" class="text-gray-800 font-medium">
                  I want to RSVP for this event
                </label>
              </div>
              <button type="submit"
                      class="px-6 py-2 bg-blue-500 text-white rounded-md shadow hover:bg-blue-600 transition">
                RSVP
              </button>
            </form>
          {% endif %}
        </div>
      {% endif %}

      <!-- Admin / Organizer Update Button -->
      {% if role == 'Admin' or role == 'Organizer' %}
        <div class="mt-10">
          <a href="{% url 'update_event' event.id %}"
             class="px-6 py-2 bg-indigo-600 text-white rounded-md shadow hover:bg-indigo-700 transition">
            Update Event
          </a>
        </div>
      {% endif %}

    </div>
  </div>
</div>
{% endblock dash %}
