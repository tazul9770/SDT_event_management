{% extends "dashboard/dashNavFoot.html" %}
<title>{% block title %}Dashboard{% endblock %}</title>
{% block dash %}
<main class="flex-grow max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 w-full">

  <h2 class="text-xl sm:text-2xl font-bold mb-8 text-gray-900">Dashboard Overview</h2>

  <!-- Stat Cards -->
  <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6 mb-12">
    <a href="{% url 'dashboard' %}" class="block">
      <div class="bg-white rounded-xl shadow-lg p-6 flex flex-col items-center justify-center hover:shadow-xl transition-shadow duration-300 cursor-pointer">
        <h3 class="text-sm font-semibold text-gray-500 mb-2 tracking-wide uppercase">Total Events</h3>
        <p class="text-3xl sm:text-4xl font-extrabold text-yellow-500">{{ total_events }}</p>
      </div>
    </a>

    <a href="{% url 'dashboard' %}?dates=todays" class="block">
      <div class="bg-white rounded-xl shadow-lg p-6 flex flex-col items-center justify-center hover:shadow-xl transition-shadow duration-300 cursor-pointer">
        <h3 class="text-sm font-semibold text-gray-500 mb-2 tracking-wide uppercase">Todays Events</h3>
        <p class="text-3xl sm:text-4xl font-extrabold text-yellow-500">{{todays_events}}</p>
      </div>
    </a>

    <a href="{% url 'dashboard' %}?dates=upcoming" class="block">
      <div class="bg-white rounded-xl shadow-lg p-6 flex flex-col items-center justify-center hover:shadow-xl transition-shadow duration-300 cursor-pointer">
        <h3 class="text-sm font-semibold text-gray-500 mb-2 tracking-wide uppercase">Upcoming Events</h3>
        <p class="text-3xl sm:text-4xl font-extrabold text-blue-600">{{upcoming_events}}</p>
      </div>
    </a>

    <a href="{% url 'dashboard' %}?dates=past" class="block">
      <div class="bg-white rounded-xl shadow-lg p-6 flex flex-col items-center justify-center hover:shadow-xl transition-shadow duration-300 cursor-pointer">
        <h3 class="text-sm font-semibold text-gray-500 mb-2 tracking-wide uppercase">Past Events</h3>
        <p class="text-3xl sm:text-4xl font-extrabold text-purple-600">{{past_events}}</p>
      </div>
    </a>

  </div>

  <h3 class="text-lg sm:text-2xl font-semibold mb-4 text-gray-700">Event List</h3>

  {% if messages %}
    {% for msg in messages %}
      <p class="text-center bg-gray-300 text-green-600 font-medium mb-4">{{msg}}</p>
    {% endfor %}
  {% endif %}

  <!-- Recent Complaints -->
  <section class="bg-white rounded-xl shadow-lg overflow-x-auto">
    <table class="min-w-full divide-y divide-gray-200 text-gray-700 text-sm sm:text-base">
      <thead class="bg-gray-50">
        <tr>
          <th scope="col" class="px-4 py-3 text-left font-semibold text-gray-500 uppercase tracking-wider">Name</th>
          <th scope="col" class="px-4 py-3 text-left font-semibold text-gray-500 uppercase tracking-wider">Category</th>
          <th scope="col" class="px-4 py-3 text-left font-semibold text-gray-500 uppercase tracking-wider">Location</th>
          <th scope="col" class="px-4 py-3 text-left font-semibold text-gray-500 uppercase tracking-wider">Date</th>
          <th scope="col" class="px-4 py-3"></th>
        </tr>
      </thead>
      <tbody class="divide-y divide-gray-100">
        {% for event in events %}
        <tr class="hover:bg-green-50 transition">
          <td class="px-4 py-3 whitespace-nowrap">{{ event.name }}</td>
          <td class="px-4 py-3 whitespace-nowrap">{{event.category.name}}</td>
          <td class="px-4 py-3 whitespace-nowrap">{{event.location}}</td>
          
          <td class="px-4 py-3 whitespace-nowrap">{{event.date|date:"F j, Y" }}</td>
          <td class="px-4 py-3 whitespace-nowrap text-right">
            {% if role == 'Admin' or role == 'Organizer' %}
              <a href="{% url 'rsvp_event' event.id %}" class="px-3 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition">
                See details
              </a>
              <form action="{% url 'delete_event' event.id %}" method="POST" style="display:inline;">
                  {% csrf_token %}
                  <button type="submit"
                  class="px-3 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition ml-2">
                  Delete
                  </button>
              </form>

            {% else %}
              <a href="{% url 'rsvp_event' event.id %}" class="px-3 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition">
                See details
              </a>
            {% endif %}
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="5" class="px-4 py-3 text-center text-gray-500">No complaints found.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </section>
</main>
{% endblock dash %}